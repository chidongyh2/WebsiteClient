<div class="row">
    <div class="col-sm-12" *ngIf="isShowForm && !isReadOnly">
        <form action="" (ngSubmit)="save()" class="form-horizontal">
            <div class="form-group" [formGroup]="model"
                 [class.has-error]="formErrors?.fullName">
                <label class="col-sm-4 control-label" ghmLabel="Người quản lý"
                       i18n-ghmLabel="@@manager"
                       [required]="true"></label>
                <div class="col-sm-8">
                    <ghm-user-suggestion [selectedUser]="userSuggestion"
                                         (userSelected)="selectUser($event)"></ghm-user-suggestion>
                    <span class="help-block">
                         {
                                formErrors?.fullName,
                                select, required {Please enter fullName}
                                maxlength {Tên người quản lý không được phép vượt quá 50 ký tự}
                         }
                     </span>
                </div>
            </div>
            <div class="form-group" [formGroup]="model"
                 [class.has-error]="formErrors?.phoneNumber">
                <label class="col-sm-4 control-label" ghmLabel="Số điện thoại"
                       i18n-ghmLabel="@@phoneNumber"></label>
                <div class="col-sm-8">
                    <input type="text" class="form-control"
                           formControlName="phoneNumber"
                           placeholder="Vui lòng nhập số điện thoại"
                           i18n-placeholder="@@phoneNumber">
                    <span class="help-block">
                                {
                                    formErrors?.phoneNumber,
                                    select, maxlength {Số điện thoại không được phép vượt quá 50 ký tự}
                                    pattern {Số điện thoại không hợp lệ}
                                }
                            </span>
                </div>
            </div>
            <div class="form-group" [formGroup]="model"
                 [class.has-error]="formErrors?.email">
                <label class="col-sm-4 control-label" ghmLabel="Email"
                       i18n-ghmLabel="@@email"></label>
                <div class="col-sm-8">
                    <input type="text" class="form-control"
                           formControlName="email"
                           placeholder="Email"
                           i18n-placeholder="@@email">
                    <span class="help-block">
                                {
                                    formErrors?.email,
                                    select, maxlength {Email không được phép vượt quá 500 ký tự}
                                    pattern {Email không hợp lệ}
                                }
                    </span>
                </div>
            </div>
            <div class="form-group" [formGroup]="model">
                <label class="col-sm-4 control-label" ghmLabel="Quyền"
                       i18n-ghmLabel="@@permission"></label>
                <div class="col-sm-8">
                    <nh-select
                        [liveSearch]="true"
                        [data]="listPermission"
                        formControlName="permissions"
                        [title]="'-- Chọn quyền --'"
                        i18n-title="@@selectPermission"
                    ></nh-select>
                </div>
            </div>
            <div class="form-group">
                <div class="col-sm-8 col-sm-offset-4">
                    <button class="btn blue cm-mgr-5" i18n="@@save">
                        Lưu
                    </button>
                    <a class="btn default" i18n="@@cancel" (click)="isShowForm = false">
                        Hủy bỏ
                    </a>
                </div>
            </div>
        </form>
    </div>
    <div class="col-sm-12">
        <table class="table table-striped table-hover">
            <thead>
            <tr>
                <th class="middle center w50" i18n="@@no">STT</th>
                <th class="middle" i18n="@@manager">Tên quản lý</th>
                <th class="middle" i18n="@@address">Số điện thoại</th>
                <th class="middle" i18n="@@description">Email</th>
                <th class="middle text-right w150" i18n="@@action"
                    *ngIf="(permission.edit || permission.delete) && !isReadOnly  ">
                    <button class="btn btn-sm blue" type="button" (click)="add()">
                        <i class="fa fa-plus"></i>
                    </button>
                </th>
            </tr>
            </thead>
            <tbody>
            <tr *ngFor="let item of listManagerConfig; let i = index"
                nhContextMenuTrigger
                [nhContextMenuTriggerFor]="nhMenu"
                [nhContextMenuData]="item">
                <td class="center middle">{{i + 1}}</td>
                <td class="middle">{{item.fullName}}</td>
                <td class="middle">{{item.phoneNumber}}</td>
                <td class="middle">{{item.email}}</td>
                <td class="text-right middle" *ngIf="(permission.edit || permission.delete) && !isReadOnly ">
                    <button mat-icon-button
                            [disableRipple]="true">
                        <mat-icon *ngIf="permission.edit"
                                  (click)="edit(item)">edit
                        </mat-icon>
                    </button>
                    <button mat-icon-button
                            color="warn"
                            [disableRipple]="true">
                        <mat-icon *ngIf="permission.delete"
                                  (click)="confirm(item)">delete
                        </mat-icon>
                    </button>
                </td>
            </tr>
            </tbody>
        </table>
    </div>
</div>

<swal
    #confirmDeleteManager
    i18n="@@confirmDeleteWarehouseManager"
    i18n-title="@@confirmTitleDeleteWarehouseManger"
    i18n-text="@@confirmTextDeleteWarehouseManger"
    title="Bạn có chắc chắn muốn xóa người quản lý này ra khỏi kho?"
    text="Lưu ý: bạn không thể khôi phục lại sau khi xóa."
    type="question"
    i18n-confirmButtonText="@@accept"
    i18n-cancelButtonText="@@cancel"
    confirmButtonText="Đồng ý"
    cancelButtonText="Hủy bỏ"
    [showCancelButton]="true"
    [focusCancel]="true">
</swal>

<nh-menu #nhMenu>
    <nh-menu-item (clicked)="edit($event)">
        <!--<i class="fa fa-edit"></i>-->
        <mat-icon>edit</mat-icon>
        <span i18n="@@edit">Sửa</span>
    </nh-menu-item>
    <nh-menu-item *ngIf="permission.delete"
                  (clicked)="confirm($event)">
        <!--<i class="fa fa-trash"></i>-->
        <mat-icon>delete</mat-icon>
        <span i18n="@@edit">Xóa</span>
    </nh-menu-item>
</nh-menu>
